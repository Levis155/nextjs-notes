# Authentication Sessions

## Understanding Authentication Sessions

When a user logs in Auth.js creates an authentication session for that user. By default, this session is represented as a JSON Web Token. The client user this JSON Web Token to identify itself.

## Accessing Sessions on the Client

To access the authentication session on the client we have to head over to our root layout i.e. `app/layout.tsx` and wrap our application inside an AuthProvider component. This component internally uses React Context to pass the session down our component tree.

**Create the AuthProvider Component:**

`app/Provider.tsx`

```TSX
import React, { ReactNode } from 'react'
import { SessionProvider } from "next-auth/react";

const AuthProvider = ({children}: {children: ReactNode}) => {
  return (
    <SessionProvider>{children}</SessionProvider>
  )
}

export default AuthProvider

```

**Wrap the application with the AuthProvider component:**

`app/layout.tsx`

```TSX
import "./globals.css";
import type { Metadata } from "next";
import { Inter } from "next/font/google";
import Navbar from "./Navbar";
import AuthProvider from "./Provider";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <AuthProvider>
          <Navbar />
          <main className="p-5">{children}</main>
        </AuthProvider>
      </body>
    </html>
  );
}

```

We can now access the session in the Navbar and show the user's name by calling the useSession hook. This returns an object which has the data property holding the name of the user as one of its properties.

`app/Navbar.tsx`

```TSX
'use client';

import { useSession } from 'next-auth/react'
import Link from 'next/link'
import React from 'react'

const Navbar = () => {
  const {status, data: session} = useSession();
  
  return (
    <div className='flex bg-slate-200 p-5 space-x-3'>
      <Link href="/" className='mr-5'>Next.js</Link>
      <Link href="/users">Users</Link>
      {status === 'loading' && <div>Loading</div>}
      {status === 'authenticated' && <div>{session.user!.name}</div>}
      {status === 'unauthenticated' && <Link href="/api/auth/signin">Login</Link>}
    </div>
  )
}

export default Navbar

```


> Because we're using the useSession hook, and we're using React Contex we have to mark the Navbar as a client component.

## Accessing Sessions on the Server

To access sessions on the server, say for instance we wanted to access the session in our homepage, we begin by calling the `auth()` function exported from `/auth.ts.` This returns a session object that we can use to access the session properties.

**app/page.tsx:**

```TSX
import Link from "next/link";
import ProductCard from "./components/ProductCard/ProductCard";
import { auth } from "@/auth";

export default async function Home() {
  const session = await auth();

  return (
    <main>
      <h1>Hello {session && <span>{session.user!.name}</span>}</h1>
      <Link href="/users">Users</Link>
      <ProductCard />
    </main>
  )
}
```

## Signing Out Users

To sign out a user the `signOut()` function from `next-auth/react` is called. This function ends the user's session, logging them out. The UI automatically updates to reflect the change in authentication status.

**app/navbar.tsx:**

```TSX
"use client";

import { useSession, signIn, signOut } from "next-auth/react";
import Link from "next/link";
import React from "react";

const Navbar = () => {
  const { status, data: session } = useSession();

  return (
    <div className="flex bg-slate-200 p-5 space-x-3">
      <Link href="/" className="mr-5">
        Next.js
      </Link>
      <Link href="/users">Users</Link>
      {status === "loading" && <div>Loading</div>}
      {status === "authenticated" && (
        <div>
          {session.user!.name}
          <button className="ml-3" onClick={() => signOut()}>
            Sign Out
          </button>
        </div>
      )}
      {status === "unauthenticated" && (
        <button onClick={() => signIn("google")}>Login</button>
      )}
    </div>
  );
};

export default Navbar;
```