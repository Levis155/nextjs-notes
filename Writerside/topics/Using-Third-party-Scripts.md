# Using Third-party Scripts

As part of integrating our applications with third-party services, we often have to add their script to one or more pages.

If the script is needed in a single page then it should be added to that page, otherwise if it's needed in multiple pages it should be added to the root layout.

For example, the code below is the script for Google Analytics. To integrate your application with Google Analytics

**app/layout.tsx:**

```TSX
import "./globals.css";
import type { Metadata } from "next";
import Script from "next/script";
import { Inter } from "next/font/google";
import Navbar from "./Navbar";
import AuthProvider from "./Provider";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <Script async src="https://www.googletagmanager.com/gtag/js?id=TAG_ID" />

      <Script>
        {`window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'TAG_ID');`}
      </Script>
      <body className={inter.className}>
        <AuthProvider>
          <Navbar />
          <main className="p-5">{children}</main>
        </AuthProvider>
      </body>
    </html>
  );
}
```

The Script component has a `strategy` property that can be set to one of the following values:

- **beforeInteractive:** When set the script is loaded before Next.js injects client-side code to our pages. We should use this strategy only for scripts that are critical and should be loaded early on. e.g. bot detectors, cookie-consent managers e.t.c.
- **afterInteractive:** It is the default strategy, and therefore we don't need to set it. With this, the script is loaded after our page becomes interactive i.e. after Next.js injects client side code into our pages. Examples of scripts that should have this strategy are tag-managers and analytics.
- **lazyOnload:** With this strategy our script is loaded after all resources in our pages have been fetched. This is useful for background or low-priority scripts that don't need to be loaded earlier on. e.g. chat-plugins, social media widgets, e.t.c.


As our application grows and is integrated with more and more third-party services, the layout gets polluted with so many `Script` components. In this case it is better to put each `Script` in a separate component as shown:

**app/GoogleAnalyticsScript.tsx:**

```TSX
import React from "react";
import Script from "next/script";

const GoogleAnalyticsScript = () => {
  return (
    <>
      <Script async src="https://www.googletagmanager.com/gtag/js?id=TAG_ID" />

      <Script>
        {`window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'TAG_ID');`}
      </Script>
    </>
  );
};

export default GoogleAnalyticsScript;

```

**app/layout.tsx:**

```TSX
import "./globals.css";
import type { Metadata } from "next";
import { Inter } from "next/font/google";
import Navbar from "./Navbar";
import AuthProvider from "./Provider";
import GoogleAnalyticsScript from "./GoogleAnalyticsScript";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <GoogleAnalyticsScript />
      <body className={inter.className}>
        <AuthProvider>
          <Navbar />
          <main className="p-5">{children}</main>
        </AuthProvider>
      </body>
    </html>
  );
}

```